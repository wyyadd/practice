package helloworld.wyyadd.sql;

import java.sql.*;

public class Bookstore {
	
	public void Insert() {
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			String dbURL = "jdbc:mysql://localhost:3306/mysql?user=wyyadd&password=Wyyadd000216.";
			Connection connection = DriverManager.getConnection(dbURL);
			String sql = "INSERT INTO bookstore (store_name, Sales, Date) values(?, ?, ?)";
			PreparedStatement pstmt = connection.prepareStatement(sql);

			pstmt.setString(1, "Los Angeles");
			pstmt.setDouble(2, 1500);
			pstmt.setDate(3, java.sql.Date.valueOf("1999-01-09"));
			pstmt.addBatch();
			pstmt.clearParameters();

			pstmt.setString(1, "San Diego");
			pstmt.setDouble(2, 250);
			pstmt.setDate(3, java.sql.Date.valueOf("1999-01-07"));
			pstmt.addBatch();
			pstmt.clearParameters(); 

			pstmt.setString(1, "Los Angeles");
			pstmt.setDouble(2, 300);
			pstmt.setDate(3, java.sql.Date.valueOf("1999-01-08"));
			pstmt.addBatch();
			pstmt.clearParameters();

			pstmt.setString(1, "Boston");
			pstmt.setDouble(2, 7000);
			pstmt.setDate(3, java.sql.Date.valueOf("1999-01-08"));
			pstmt.addBatch();
			pstmt.clearParameters();

			pstmt.executeBatch();
			pstmt.clearBatch();
			System.out.println("success\n");
		}catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		Bookstore foo = new Bookstore();
		foo.Insert();
	}

}
